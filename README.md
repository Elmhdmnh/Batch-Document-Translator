# 批量文档翻译器

一个基于Python的图形界面批量文档翻译工具，支持多种文档格式，使用OpenAI API进行高质量翻译。

## 功能特点

- 📁 **多格式支持**: 支持 `.docx`、`.doc`、`.txt` 文件格式
- 🔤 **智能分块**: 自动将长文档分割成适当大小的文本块进行翻译
- 🎯 **自定义翻译**: 可指定目标语言和翻译风格
- 📊 **进度显示**: 实时显示翻译进度和日志信息
- 🛡️ **错误重试**: 内置重试机制，提高翻译成功率
- 💾 **双格式输出**: 同时生成TXT和DOCX格式的翻译结果

## 安装依赖

在运行前，请安装所需依赖：


pip install python-docx docx2txt requests pywin32
注意: pywin32 仅在Windows系统上需要，用于处理 .doc 文件。

使用方法
1. 配置API参数
API Key: 输入您的OpenAI API密钥

Base URL: 设置API基础地址（默认为官方OpenAI API）

Model: 选择使用的模型（默认为 gpt-4o-mini）

2. 设置翻译参数
目标语言: 指定翻译目标语言（如：中文、英文、日文等）

翻译风格: 指定翻译风格要求（如：信达雅、简洁、专业等）

3. 选择文件
点击"选择文件（多选）"按钮，选择要翻译的文档文件

支持批量选择多个文件

4. 设置输出目录
指定翻译结果保存的目录

默认为当前工作目录

5. 开始翻译
点击"开始翻译"按钮启动翻译过程

可随时点击"停止"按钮中断翻译

输出文件
翻译完成后，每个源文件会生成两个输出文件：

{原文件名}_translated.txt - 纯文本格式

{原文件名}_translated.docx - Word文档格式

技术细节
文本分块策略
最大分块字符数：15,000字符

按段落分割，保持语义完整性

自动处理长段落拆分

API兼容性
支持多种API端点格式：

/v1/chat/completions

/chat/completions

/v1/responses

/responses

错误处理
自动重试机制（最多3次）

详细的错误日志记录

网络超时处理（120秒）

注意事项
API费用: 使用OpenAI API会产生相应费用，请关注使用量

网络要求: 需要稳定的网络连接访问API服务

文件编码: TXT文件使用UTF-8编码处理

文档格式: 翻译会尽量保持原文的段落结构

性能建议: 大文件翻译可能需要较长时间，建议分批处理

故障排除
常见问题
.doc文件无法处理: 确保已安装 pywin32 且运行在Windows系统

API连接失败: 检查API Key和Base URL设置

内存不足: 过大的文件可能导致内存问题，建议拆分文件

日志查看
程序提供详细的运行日志，可通过界面查看或使用"清空日志"功能重置。
